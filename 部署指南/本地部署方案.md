# 朋友圈自动发布系统 - 本地部署方案

## 🎯 推荐配置

### 💻 硬件要求
- **电脑配置**：普通办公电脑即可
- **内存要求**：8GB以上
- **存储空间**：至少10GB可用空间
- **网络要求**：稳定的网络连接

### 🛠️ 软件环境
- **操作系统**：Windows 10/11（推荐）
- **Node.js**：已安装 ✅
- **影刀RPA**：需要购买和安装
- **浏览器**：Chrome（影刀RPA推荐）

## 📋 部署步骤

### 第一步：准备工作目录
```bash
# 在您的项目文件夹下创建
mkdir 朋友圈自动发布系统
cd 朋友圈自动发布系统

# 创建必要的子目录
mkdir temp
mkdir temp/images
mkdir temp/configs
mkdir logs
```

### 第二步：安装依赖
```bash
# 安装Node.js依赖包
npm init -y
npm install express node-cron sharp

# 如果使用Playwright（备选方案）
npm install playwright
```

### 第三步：配置文件设置
```javascript
// config.json
{
  "feishu": {
    "apiBase": "https://open.feishu.cn/open-apis",
    "appToken": "您的飞书应用Token",
    "tableId": "您的表格ID",
    "accessToken": "您的访问Token"
  },
  "server": {
    "port": 3000,
    "host": "localhost"
  },
  "rpa": {
    "tool": "yingdao", // 影刀RPA
    "configPath": "./temp/configs"
  },
  "duixueqiu": {
    "baseUrl": "https://duixueqiu.com",
    "loginCredentials": {
      "username": "您的堆雪球账号",
      "password": "您的堆雪球密码"
    }
  }
}
```

### 第四步：启动服务
```bash
# 启动Node.js中间服务器
node 飞书RPA衔接服务.js

# 看到这个提示就成功了：
# 飞书RPA衔接服务已启动，端口: 3000
# 状态查看: http://localhost:3000/status
```

## 🔧 影刀RPA配置

### 购买和安装
1. **官网**：https://www.yingdao.com/
2. **版本选择**：个人版或企业版
3. **安装位置**：建议默认路径

### RPA流程设计
```
影刀RPA流程：
1. 打开浏览器
2. 登录堆雪球系统
3. 读取配置文件（Node.js传递的任务数据）
4. 填写文案内容
5. 上传图片
6. 选择微信号
7. 设置发布时间
8. 提交发布
9. 返回结果给Node.js服务器
```

### 防封策略配置
```
影刀RPA设置：
- 操作间隔：随机500-2000ms
- 鼠标轨迹：启用人工模拟
- 浏览器指纹：使用真实浏览器
- 代理设置：如需要可配置
```

## 📊 运行监控

### 本地监控界面
访问 `http://localhost:3000/status` 查看：
- 当前任务队列状态
- RPA运行状态
- 最近发布记录
- 错误日志

### 日志文件
```
logs/
├── system.log      # 系统运行日志
├── rpa.log        # RPA执行日志
├── error.log      # 错误日志
└── publish.log    # 发布记录
```

## ⚠️ 注意事项

### 电脑运行要求
- **保持开机**：服务需要24小时运行
- **网络稳定**：避免网络中断影响发布
- **定期重启**：建议每周重启一次电脑
- **系统更新**：避免在发布时间段更新系统

### 安全建议
- **账号安全**：定期更换堆雪球密码
- **数据备份**：定期备份飞书表格数据
- **访问控制**：本地服务器只允许本机访问
- **日志清理**：定期清理过期日志文件

### 故障处理
```bash
# 服务器无响应
ps aux | grep node  # 查看进程
kill -9 [进程ID]    # 强制结束
node 飞书RPA衔接服务.js  # 重新启动

# RPA执行失败
# 检查影刀RPA是否正常运行
# 检查堆雪球网站是否可访问
# 查看error.log错误信息
```

## 💰 成本估算

### 软件成本
- **影刀RPA**：约500-2000元/年（根据版本）
- **Node.js**：免费
- **其他工具**：免费

### 运行成本
- **电费**：约50-100元/月（24小时开机）
- **网络费用**：现有网络即可
- **维护成本**：主要是时间成本

## 🚀 扩展方案

### 云服务器部署（可选）
如果需要更稳定的运行：
- **阿里云ECS**：约100-300元/月
- **腾讯云CVM**：约100-300元/月
- **优点**：24小时稳定运行，不占用本地电脑

### 多账号管理
- 支持多个微信号轮换发布
- 支持多个堆雪球账号
- 降低单账号风险

## 📞 技术支持

### 常见问题
1. **Node.js服务器启动失败**：检查端口是否被占用
2. **飞书API调用失败**：检查Token是否过期
3. **RPA执行失败**：检查影刀RPA是否正常运行
4. **图片上传失败**：检查图片格式和大小

### 联系方式
- 遇到问题可以随时咨询
- 提供详细的错误日志
- 描述具体的操作步骤
